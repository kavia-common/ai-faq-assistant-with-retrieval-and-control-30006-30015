{"is_source_file": true, "format": "TypeScript", "description": "Angular component for a chatbox interface connecting to RAG service; manages messages, filtering, user input, and UI behavior.", "external_files": ["./chatbox.component.html", "./chatbox.component.css"], "external_methods": ["this.topicsBridge.topic$.subscribe", "this.rag.ask", "globalThis.requestAnimationFrame", "document.querySelector"], "published": ["send", "clear"], "classes": [{"name": "ChatboxComponent", "description": "Main Angular component handling chat interactions with AI, including message management, filtering, and UI updates."}], "methods": [{"name": "private filterInput(raw: string): { cleaned: string | null; feedback?: string } { filterInput", "description": "Sanitizes and filters user input, providing feedback if input is empty or contains banned words.", "scope": "ChatboxComponent", "scopeKind": "class"}, {"name": "private buildFilterDataset(): ChatMessage[] { buildFilterDataset", "description": "Builds a dataset from current messages for filtering.", "scope": "ChatboxComponent", "scopeKind": "class"}, {"name": "private computeFilteredResults(query: string): ChatMessage[] { computeFilteredResults", "description": "Filters messages based on query and active topic.", "scope": "ChatboxComponent", "scopeKind": "class"}, {"name": "private resetFilterView() { resetFilterView", "description": "Resets filtering state to show full conversation.", "scope": "ChatboxComponent", "scopeKind": "class"}, {"name": "async send() { send", "description": "Handles sending user message, triggering AI response, and updating message list and filtered view.", "scope": "ChatboxComponent", "scopeKind": "class"}, {"name": "clear() { clear", "description": "Resets the conversation to initial state.", "scope": "ChatboxComponent", "scopeKind": "class"}, {"name": "ngOnDestroy(): void { ngOnDestroy", "description": "Handles cleanup by unsubscribing from topic updates.", "scope": "ChatboxComponent", "scopeKind": "class"}, {"name": "constructor( constructor", "scope": "ChatboxComponent", "scopeKind": "class", "description": "unavailable"}], "calls": ["this.topicsBridge.topic$.subscribe", "this.rag.ask", "globalThis.requestAnimationFrame", "document.querySelector"], "search-terms": ["Angular Chatbox component", "RAG service", "topic filtering", "message filtering", "AI assistant chat UI", "Angular lifecycle", "subscribe to topic", "send message", "clear conversation"], "state": 2, "file_id": 30, "knowledge_revision": 92, "git_revision": "1fb407bc66403f3ee081ad3694da7f13a17f9a28", "revision_history": [{"66": ""}, {"84": ""}, {"87": ""}, {"89": "7c498a08d76dbab3cffecb73c11abf1e6e8c58a0"}, {"92": "1fb407bc66403f3ee081ad3694da7f13a17f9a28"}], "ctags": [{"_type": "tag", "name": "ChatboxComponent", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^export class ChatboxComponent implements OnDestroy {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "activeTopic", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^  private activeTopic: string | null = null;$/", "language": "TypeScript", "kind": "property", "scope": "ChatboxComponent", "scopeKind": "class"}, {"_type": "tag", "name": "buildFilterDataset", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^  private buildFilterDataset(): ChatMessage[] {$/", "language": "TypeScript", "kind": "method", "scope": "ChatboxComponent", "scopeKind": "class"}, {"_type": "tag", "name": "cleaned", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^    const { cleaned, feedback } = this.filterInput(this.input);$/", "language": "TypeScript", "kind": "constant", "scope": "ChatboxComponent.send", "scopeKind": "method"}, {"_type": "tag", "name": "clear", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^  clear() {$/", "language": "TypeScript", "kind": "method", "scope": "ChatboxComponent", "scopeKind": "class"}, {"_type": "tag", "name": "computeFilteredResults", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^  private computeFilteredResults(query: string): ChatMessage[] {$/", "language": "TypeScript", "kind": "method", "scope": "ChatboxComponent", "scopeKind": "class"}, {"_type": "tag", "name": "constructor", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^  constructor($/", "language": "TypeScript", "kind": "method", "scope": "ChatboxComponent", "scopeKind": "class"}, {"_type": "tag", "name": "d", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^          const d: any = (globalThis as any).document;$/", "language": "TypeScript", "kind": "constant", "scope": "ChatboxComponent.send", "scopeKind": "method"}, {"_type": "tag", "name": "d", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^          const list = d && typeof d.querySelector === 'function' ? d.querySelector('.messages')/", "language": "TypeScript", "kind": "constant", "scope": "ChatboxComponent.send", "scopeKind": "method"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^    const data = this.buildFilterDataset();$/", "language": "TypeScript", "kind": "constant", "scope": "ChatboxComponent.computeFilteredResults", "scopeKind": "method"}, {"_type": "tag", "name": "errMsg", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^      const errMsg: ChatMessage = {$/", "language": "TypeScript", "kind": "constant", "scope": "ChatboxComponent.send", "scopeKind": "method"}, {"_type": "tag", "name": "feedback", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^    const { cleaned, feedback } = this.filterInput(this.input);$/", "language": "TypeScript", "kind": "constant", "scope": "ChatboxComponent.send", "scopeKind": "method"}, {"_type": "tag", "name": "filterFeedback", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^  filterFeedback: string | null = null;$/", "language": "TypeScript", "kind": "property", "scope": "ChatboxComponent", "scopeKind": "class"}, {"_type": "tag", "name": "filterInput", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^  private filterInput(raw: string): { cleaned: string | null; feedback?: string } {$/", "language": "TypeScript", "kind": "method", "scope": "ChatboxComponent", "scopeKind": "class"}, {"_type": "tag", "name": "filterMatches", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^  filterMatches = false;$/", "language": "TypeScript", "kind": "property", "scope": "ChatboxComponent", "scopeKind": "class"}, {"_type": "tag", "name": "filteredMessages", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^  filteredMessages: ChatMessage[] = [];$/", "language": "TypeScript", "kind": "property", "scope": "ChatboxComponent", "scopeKind": "class"}, {"_type": "tag", "name": "g", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^        const g: any = globalThis as any;$/", "language": "TypeScript", "kind": "constant", "scope": "ChatboxComponent.send", "scopeKind": "method"}, {"_type": "tag", "name": "i", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^      const isContextNote = m.role === 'system' && \\/Context updated to topic\\/i.test(m.content)/", "language": "TypeScript", "kind": "constant", "scope": "ChatboxComponent.computeFilteredResults", "scopeKind": "method"}, {"_type": "tag", "name": "inTopic", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^    const inTopic = this.activeTopic;$/", "language": "TypeScript", "kind": "constant", "scope": "ChatboxComponent.computeFilteredResults", "scopeKind": "method"}, {"_type": "tag", "name": "input", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^  input = '';$/", "language": "TypeScript", "kind": "property", "scope": "ChatboxComponent", "scopeKind": "class"}, {"_type": "tag", "name": "isContextNote", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^      const isContextNote = m.role === 'system' && \\/Context updated to topic\\/i.test(m.content)/", "language": "TypeScript", "kind": "constant", "scope": "ChatboxComponent.computeFilteredResults", "scopeKind": "method"}, {"_type": "tag", "name": "lastQuery", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^  lastQuery: string = '';$/", "language": "TypeScript", "kind": "property", "scope": "ChatboxComponent", "scopeKind": "class"}, {"_type": "tag", "name": "list", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^          const list = d && typeof d.querySelector === 'function' ? d.querySelector('.messages')/", "language": "TypeScript", "kind": "constant", "scope": "ChatboxComponent.send", "scopeKind": "method"}, {"_type": "tag", "name": "messages", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^  messages: ChatMessage[] = [$/", "language": "TypeScript", "kind": "property", "scope": "ChatboxComponent", "scopeKind": "class"}, {"_type": "tag", "name": "ngOnDestroy", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^  ngOnDestroy(): void {$/", "language": "TypeScript", "kind": "method", "scope": "ChatboxComponent", "scopeKind": "class"}, {"_type": "tag", "name": "platformId", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^    @Inject(PLATFORM_ID) private platformId: Object$/", "language": "TypeScript", "kind": "property", "scope": "ChatboxComponent", "scopeKind": "class"}, {"_type": "tag", "name": "q", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^    const q = query.toLowerCase();$/", "language": "TypeScript", "kind": "constant", "scope": "ChatboxComponent.computeFilteredResults", "scopeKind": "method"}, {"_type": "tag", "name": "raf", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^        const raf: (cb: () => void) => void =$/", "language": "TypeScript", "kind": "constant", "scope": "ChatboxComponent.send", "scopeKind": "method"}, {"_type": "tag", "name": "rag", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^    private rag: RagService,$/", "language": "TypeScript", "kind": "property", "scope": "ChatboxComponent", "scopeKind": "class"}, {"_type": "tag", "name": "resetFilterView", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^  private resetFilterView() {$/", "language": "TypeScript", "kind": "method", "scope": "ChatboxComponent", "scopeKind": "class"}, {"_type": "tag", "name": "response", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^      const response = await this.rag.ask(cleaned, { topic: this.activeTopic ?? undefined });$/", "language": "TypeScript", "kind": "constant", "scope": "ChatboxComponent.send", "scopeKind": "method"}, {"_type": "tag", "name": "send", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^  async send() {$/", "language": "TypeScript", "kind": "method", "scope": "ChatboxComponent", "scopeKind": "class"}, {"_type": "tag", "name": "sending", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^  sending = false;$/", "language": "TypeScript", "kind": "property", "scope": "ChatboxComponent", "scopeKind": "class"}, {"_type": "tag", "name": "showMaskNote", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^    const showMaskNote = !!feedback && \\/masked\\/i.test(feedback);$/", "language": "TypeScript", "kind": "constant", "scope": "ChatboxComponent.send", "scopeKind": "method"}, {"_type": "tag", "name": "sub", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^  private sub: any;$/", "language": "TypeScript", "kind": "property", "scope": "ChatboxComponent", "scopeKind": "class"}, {"_type": "tag", "name": "topicsBridge", "path": "/home/kavia/workspace/code-generation/ai-faq-assistant-with-retrieval-and-control-30006-30015/faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "pattern": "/^    private topicsBridge: TopicsBridgeService,$/", "language": "TypeScript", "kind": "property", "scope": "ChatboxComponent", "scopeKind": "class"}], "hash": "19d22a73cb16f8a39a61b35fd2792464", "format-version": 4, "code-base-name": "faq_chatbox_frontend", "filename": "faq_chatbox_frontend/src/app/chat/chatbox.component.ts", "fields": [{"name": "private activeTopic: string | null = null;", "scope": "ChatboxComponent", "scopeKind": "class", "description": "unavailable"}, {"name": "filterFeedback: string | null = null;", "scope": "ChatboxComponent", "scopeKind": "class", "description": "unavailable"}, {"name": "filterMatches = false;", "scope": "ChatboxComponent", "scopeKind": "class", "description": "unavailable"}, {"name": "filteredMessages: ChatMessage[] = [];", "scope": "ChatboxComponent", "scopeKind": "class", "description": "unavailable"}, {"name": "input = '';", "scope": "ChatboxComponent", "scopeKind": "class", "description": "unavailable"}, {"name": "lastQuery: string = '';", "scope": "ChatboxComponent", "scopeKind": "class", "description": "unavailable"}, {"name": "messages: ChatMessage[] = [", "scope": "ChatboxComponent", "scopeKind": "class", "description": "unavailable"}, {"name": "@Inject(PLATFORM_ID) private platformId: Object", "scope": "ChatboxComponent", "scopeKind": "class", "description": "unavailable"}, {"name": "private rag: RagService,", "scope": "ChatboxComponent", "scopeKind": "class", "description": "unavailable"}, {"name": "sending = false;", "scope": "ChatboxComponent", "scopeKind": "class", "description": "unavailable"}, {"name": "private sub: any;", "scope": "ChatboxComponent", "scopeKind": "class", "description": "unavailable"}, {"name": "private topicsBridge: TopicsBridgeService,", "scope": "ChatboxComponent", "scopeKind": "class", "description": "unavailable"}]}